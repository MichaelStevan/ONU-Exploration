library(data.table)
dt = fread("/Users/michael/Downloads/Rtest/WPP2017_TotalPopulationBySex.csv")
summary(dt)
names(dt)
View(dt)
head(dt)
dt[,`:=`(Variant=factor(Variant))]
summary(dt)
head(dt)
str(dt)
dt$MidPeriod
str(dt)
dt$Time
dt[,`:=`(Variant=factor(Variant),Time=Date(Time))]
summary(dt)
dt[,`:=`(Location=factor(Location),Variant=factor(Variant),Time=Date(Time))]
summary(dt)
dt[,`:=`(Location=factor(Location),Variant=factor(Variant),Time=as.Date(Time))]
library(lubridate)
dt[,`:=`(Location=factor(Location),Variant=factor(Variant),Time=y(Time))]
dt[,`:=`(Location=factor(Location),Variant=factor(Variant),Time=year(Time))]
summary(dt)
library(lubridate)
dt[,`:=`(Location=factor(Location),Variant=factor(Variant),Time=year(Time))]
dt[,`:=`(Location=factor(Location),Variant=factor(Variant),Time=as.Date(Time,format="%Y"))]
?as.Date
as.Date(1945)
Sys.now()
Sys.Date()
dt$Time
str(dt)
dt[,`:=`(Location=factor(Location),Variant=factor(Variant))]
summary(dt)
dt[,`:=`(Location=factor(Location),Variant=factor(Variant),Time=as.Date(ISOdate(Time,1,1)))]
summary(dt)
dt[,`:=`(Location=factor(Location),Variant=factor(Variant),Time=as.Date(ISOdate(Time,12,31)))]
summary(dt)
dt = dt[,.(PopMale,PopFemale,PopTotal),.(Location,Time,VarID)]
dt
dt[,`:=`(Location=factor(Location),Variant=factor(Variant),Time=as.Date(ISOdate(Time,12,31)))]
summary(dt)
dt = dt[,.(PopMale,PopFemale,PopTotal),.(Location,Time,Variant)]
dt = fread("/Users/michael/Downloads/Rtest/WPP2017_TotalPopulationBySex.csv")
head(dt)
dt[,`:=`(Location=factor(Location),Variant=factor(Variant),Time=as.Date(ISOdate(Time,12,31)))]
summary(dt)
dt = dt[,.(PopMale,PopFemale,PopTotal),.(Location,Time,Variant)]
dt
?data.table
dt[,.(plot(PopTotal,Time)),.(Location,Time,Variant)]
dt[,.(plot(PopTotal)),.(Location,Time,Variant)]
dt
dt[Location=='Spain']
dt[Location=='Spain',NuevaColumn:=.N,.(Time)]
dt[,NuevaColumn:=.N,.(Time)]
dt
dt[,NuevaColumn:=NULL]
dt
dt[Location=="Spain",Time:=1]
dt[Location=="Spain"]
dt[Location=="Spain"]
dt = dt[Location=="Spain",Time=1]
dt = dt[Location=="Spain",.(Time=1)]
dt = dt[Location=="Spain",.(Time=1)]
dt
dt[,.(plot(PopTotal)),.(Location)]
dt = fread("/Users/michael/Downloads/Rtest/WPP2017_TotalPopulationBySex.csv")
head(dt)
dt[,`:=`(Location=factor(Location),Variant=factor(Variant),Time=as.Date(ISOdate(Time,12,31)))]
summary(dt)
dt = dt[,.(PopMale,PopFemale,PopTotal),.(Location,Time,Variant)]
dt[,.(plot(PopTotal)),.(Location)]
length(unique(dt$location))
length(unique(dt$Location))
spain = dt[Location=="Spain",.(PopTotal,Time)].copy()
spain = copy(dt[Location=="Spain",.(PopTotal,Time)])
plot(Time,PopTotal,data=spain)
plot(spain$Time,spain$PopTotal,type="l")
library(data.table)
library(ggplot2)
dt = fread("/Users/michael/Downloads/Rtest/WPP2017_TotalPopulationBySex.csv")
head(dt)
dt[,`:=`(Location=factor(Location),Variant=factor(Variant),Time=as.Date(ISOdate(Time,12,31)))]
summary(dt)
spain = copy(dt[Location=="Spain",.(PopTotal,Time,Variant)])
spain
spain = copy(dt[Location=="Spain"&Variant=="Medium",.(PopTotal,Time,Variant)])
plot(spain$Time,spain$PopTotal,type="l")
plot(spain$Time,spain$PopTotal,type="l",color="red")
plot(spain$Time,spain$PopTotal,type="l",col="red")
spain = copy(dt[Location=="Spain",.(PopTotal,Time,Variant)])
plot(spain$Time,spain$PopTotal,type="l",col="red")
?ggplot
ggplot(data=spain,aes(x=Time,y=PopTotal,col=Variant))
ggplot(data=spain,aes(x=Time,y=PopTotal,col=Variant))+
geom_point()
ggplot(data=spain,aes(x=Time,y=PopTotal,col=Variant))+
geom_line()
ggplot(data=spain,aes(x=Time,y=PopTotal,col=Variant))+
geom_line()+
theme_minimal()
ggplot(data=spain,aes(x=Time,y=PopTotal,col=Variant))+
geom_line()+
theme_minimal()+
title("Spain's Total Population by Variant")
ggplot(data=spain,aes(x=Time,y=PopTotal,col=Variant))+
geom_line()+
theme_minimal()+
main("Spain's Total Population by Variant")
ggplot(data=spain,aes(x=Time,y=PopTotal,col=Variant))+
geom_line()+
theme_minimal()+
ggtitle("Spain's Total Population by Variant")
for(location in unique(dt$Location)){
location = copy(dt[Location==location,.(PopTotal,Time,Variant)])
ggplot(data=location,aes(x=Time,y=PopTotal,col=Variant))+
geom_line()+
theme_minimal()+
ggtitle(paste(location,"'s Total Population by Variant"))
}
for(location in unique(dt$Location)){
print(location)
location = copy(dt[Location==location,.(PopTotal,Time,Variant)])
ggplot(data=location,aes(x=Time,y=PopTotal,col=Variant))+
geom_line()+
theme_minimal()+
ggtitle(paste(location,"'s Total Population by Variant"))
}
warnings()
dev.off()
for(location in unique(dt$Location)){
print(location)
location = copy(dt[Location==location,.(PopTotal,Time,Variant)])
ggplot(data=location,aes(x=Time,y=PopTotal,col=Variant))+
geom_line()+
theme_minimal()+
ggtitle(paste(location,"'s Total Population by Variant"))
break
}
for(location in unique(dt$Location)){
print(location)
location = copy(dt[Location==location,.(PopTotal,Time,Variant)])
print(ggplot(data=location,aes(x=Time,y=PopTotal,col=Variant))+
geom_line()+
theme_minimal()+
ggtitle(paste(location,"'s Total Population by Variant")))
break
}
for(location in unique(dt$Location)){
print(location)
dt = copy(dt[Location==location,.(PopTotal,Time,Variant)])
print(ggplot(data=dt,aes(x=Time,y=PopTotal,col=Variant))+
geom_line()+
theme_minimal()+
ggtitle(paste(location,"'s Total Population by Variant")))
}
library(data.table)
library(ggplot2)
dt = fread("/Users/michael/Downloads/Rtest/WPP2017_TotalPopulationBySex.csv")
head(dt)
dt[,`:=`(Location=factor(Location),Variant=factor(Variant),Time=as.Date(ISOdate(Time,12,31)))]
summary(dt)
dt = dt[,.(PopMale,PopFemale,PopTotal),.(Location,Time,Variant)]
for(location in unique(dt$Location)){
print(location)
location_dt = copy(dt[Location==location,.(PopTotal,Time,Variant)])
print(ggplot(data=dt,aes(x=Time,y=PopTotal,col=Variant))+
geom_line()+
theme_minimal()+
ggtitle(paste(location,"'s Total Population by Variant")))
}
library(data.table)
library(ggplot2)
dt = fread("/Users/michael/Downloads/Rtest/WPP2017_TotalPopulationBySex.csv")
head(dt)
dt[,`:=`(Location=factor(Location),Variant=factor(Variant),Time=as.Date(ISOdate(Time,12,31)))]
summary(dt)
dt = dt[,.(PopMale,PopFemale,PopTotal),.(Location,Time,Variant)]
for(location in unique(dt$Location)){
print(location)
location_dt = copy(dt[Location==location,.(PopTotal,Time,Variant)])
print(ggplot(data=location_dt,aes(x=Time,y=PopTotal,col=Variant))+
geom_line()+
theme_minimal()+
ggtitle(paste(location,"'s Total Population by Variant")))
}
dt[,gt2017:=Time>as.Date(ISOdate(2017,12,31))]
dt
for(location in unique(dt$Location)){
print(location)
location_dt = copy(dt[Location==location,.(PopTotal,Time,Variant)])
print(ggplot(data=location_dt,aes(x=Time,y=PopTotal,col=Variant,linetype=gt2017))+
geom_line()+
theme_minimal()+
ggtitle(paste(location,"'s Total Population by Variant")))
break
}
for(location in unique(dt$Location)){
print(location)
location_dt = copy(dt[Location==location,.(PopTotal,Time,Variant,gt2017)])
print(ggplot(data=location_dt,aes(x=Time,y=PopTotal,col=Variant,linetype=gt2017))+
geom_line()+
theme_minimal()+
ggtitle(paste(location,"'s Total Population by Variant")))
break
}
for(location in unique(dt$Location)){
print(location)
location_dt = copy(dt[Location==location,.(PopTotal,Time,Variant,gt2017)])
print(ggplot(data=location_dt,aes(x=Time,y=PopTotal,col=Variant,linetype=gt2017))+
geom_line(size=2)+
theme_minimal()+
ggtitle(paste(location,"'s Total Population by Variant")))
break
}
for(location in unique(dt$Location)){
print(location)
location_dt = copy(dt[Location==location,.(PopTotal,Time,Variant,gt2017)])
print(ggplot(data=location_dt,aes(x=Time,y=PopTotal,col=Variant,linetype=gt2017))+
geom_line(size=1.5)+
theme_minimal()+
ggtitle(paste(location,"'s Total Population by Variant")))
break
}
for(location in unique(dt$Location)){
print(location)
location_dt = copy(dt[Location==location,.(PopTotal,Time,Variant,gt2017)])
print(ggplot(data=location_dt,aes(x=Time,y=PopTotal,col=Variant,linetype=gt2017))+
geom_line(size=1.5)+
theme_minimal()+
guides(linetype=F)+
ggtitle(paste(location,"'s Total Population by Variant")))
break
}
a<-1
a
a<<-1
a
for(location in unique(dt$Location)){
print(location)
location_dt = copy(dt[Location==location,.(PopTotal,Time,Variant,gt2017)])
ggplot(data=location_dt,aes(x=Time,y=PopTotal,col=Variant,linetype=gt2017))+
geom_line(size=1.5)+
theme_minimal()+
guides(linetype=F)+
ggtitle(paste(location,"'s Total Population by Variant"))
ggsave(paste0("./PopTotal/",location,".png"))
break
}
for(location in unique(dt$Location)){
print(location)
location_dt = copy(dt[Location==location,.(PopTotal,Time,Variant,gt2017)])
ggplot(data=location_dt,aes(x=Time,y=PopTotal,col=Variant,linetype=gt2017))+
geom_line(size=1.5)+
theme_minimal()+
guides(linetype=F)+
ggtitle(paste(location,"'s Total Population by Variant"))
ggsave(paste0("./PopTotal/",location,".png"))
}
dev.off()
for(location in unique(dt$Location)){
location_dt = copy(dt[Location==location,.(PopTotal,Time,Variant,gt2017)])
ggplot(data=location_dt,aes(x=Time,y=PopTotal,col=Variant,linetype=gt2017))+
geom_line(size=1.5)+
theme_minimal()+
guides(linetype=F)+
ggtitle(paste(location,"'s Total Population by Variant"))
ggsave(paste0("./PopTotal/",location,".png"))
}
for(location in unique(dt$Location)){
location_dt = copy(dt[Location==location,.(PopTotal,Time,Variant,gt2017)])
ggplot(data=location_dt,aes(x=Time,y=PopTotal,col=Variant,linetype=gt2017))+
geom_line(size=1.5)+
theme_minimal()+
guides(linetype=F)+
ggtitle(paste(location,"'s Total Population by Variant"))
# Save file in new directory if it exists
path = paste0("./PopTotal/",location,".png")
dir.create(path,showWarnings=F)
ggsave(path)
}
dir.create(path = )
dir.create(path )
dir.create(path)
path = './PopTotal/Australia/'
dir.create(path)
strsplit(path)
strsplit(path,"/")
View(dt)
s = 1:8
s[[length(s)]]
location = unique(dt$Location)[1]
# Save file in new directory if it exists
loc_v = strsplit(location,"/")
location
library(data.table)
library(ggplot2)
dt = fread("/Users/michael/Downloads/Rtest/WPP2017_TotalPopulationBySex.csv")
head(dt)
dt[,`:=`(Location=factor(Location),Variant=factor(Variant),Time=as.Date(ISOdate(Time,12,31)))]
summary(dt)
dt = dt[,.(PopMale,PopFemale,PopTotal),.(Location,Time,Variant)]
dt[,gt2017:=Time>as.Date(ISOdate(2017,12,31))]
for(location in unique(dt$Location)){
location_dt = copy(dt[Location==location,.(PopTotal,Time,Variant,gt2017)])
ggplot(data=location_dt,aes(x=Time,y=PopTotal,col=Variant,linetype=gt2017))+
geom_line(size=1.5)+
theme_minimal()+
guides(linetype=F)+
ggtitle(paste(location,"'s Total Population by Variant"))
# Save file in new directory if it exists
loc_v = strsplit(location,"/")
file = tail(loc_v,1)
folder = loc_v[1:length(loc_v)-1]
dir_path = paste0("./PopTotal/",folder)
dir.create(dir_path,showWarnings=F)
ggsave(paste0(path,file,".png"))
}
for(location in unique(dt$Location)){
location_dt = copy(dt[Location==location,.(PopTotal,Time,Variant,gt2017)])
ggplot(data=location_dt,aes(x=Time,y=PopTotal,col=Variant,linetype=gt2017))+
geom_line(size=1.5)+
theme_minimal()+
guides(linetype=F)+
ggtitle(paste(location,"'s Total Population by Variant"))
# Save file in new directory if it exists
loc_v = strsplit(location,"/")
file = tail(loc_v,1)
folder = loc_v[1:length(loc_v)-1]
dir_path = paste0("./PopTotal/",folder)
dir.create(dir_path,showWarnings=F)
ggsave(paste0(dir_path,file,".png"))
}
s = "Madrid","Malaga"
s = c("Madrid","Malaga")
s = "Madrid/ Barajas"
loc_v = strsplit(s,"/")
loc_v
file = tail(loc_v,1)
file
tail(loc_v,1)
loc_v[1]
tail(loc_v[1],1)
?strsplit
loc_v = unlist(strsplit(s,"/"))
loc_v
file = tail(loc_v,1)
file
folder = paste0(loc_v[1:length(loc_v)-1]
folder
folder = loc_v[1:length(loc_v)-1]
for (variable in vector) {
}
folder
s = "Madrid/Barajas/Terminal1"
loc_v = unlist(strsplit(s,"/"))
loc_v
file = trim(tail(loc_v,1))
?trim
trim = function(x) sub("^\\s+","",x)
file = trim(tail(loc_v,1))
file
folder = loc_v[1:length(loc_v)-1]
folder
paste0(folder,"/")
paste0(paste0(folder,"/"))
paste0(unlist(paste0(folder,"/")))
paste0(folder,"/")
paste0(folder,"/",collapse = T)
paste0(folder,collapse="/")
library(data.table)
library(ggplot2)
dt = fread("/Users/michael/Downloads/Rtest/WPP2017_TotalPopulationBySex.csv")
head(dt)
dt[,`:=`(Location=factor(Location),Variant=factor(Variant),Time=as.Date(ISOdate(Time,12,31)))]
summary(dt)
dt = dt[,.(PopMale,PopFemale,PopTotal),.(Location,Time,Variant)]
dt[,gt2017:=Time>as.Date(ISOdate(2017,12,31))]
# 273
trim = function(x) sub("^\\s+","",x)
for(location in unique(dt$Location)){
location_dt = copy(dt[Location==location,.(PopTotal,Time,Variant,gt2017)])
ggplot(data=location_dt,aes(x=Time,y=PopTotal,col=Variant,linetype=gt2017))+
geom_line(size=1.5)+
theme_minimal()+
guides(linetype=F)+
ggtitle(paste(location,"'s Total Population by Variant"))
# Save file in new directory if it exists
loc_v = unlist(strsplit(location,"/"))
file = trim(tail(loc_v,1))
folder = paste0(loc_v[1:length(loc_v)-1],collapse = "/")
dir_path = paste0("./PopTotal/",folder,"/")
dir.create(dir_path,showWarnings=F)
ggsave(paste0(dir_path,file,".png"))
}
library(data.table)
library(ggplot2)
dt = fread("/Users/michael/Downloads/Rtest/WPP2017_TotalPopulationBySex.csv")
head(dt)
dt[,`:=`(Location=factor(Location),Variant=factor(Variant),Time=as.Date(ISOdate(Time,12,31)))]
summary(dt)
dt = dt[,.(PopMale,PopFemale,PopTotal),.(Location,Time,Variant)]
dt[,gt2017:=Time>as.Date(ISOdate(2017,12,31))]
trim = function(x) sub("^\\s+","",x)
for(location in unique(dt$Location)){
location_dt = copy(dt[Location==location,.(PopTotal,Time,Variant,gt2017)])
ggplot(data=location_dt,aes(x=Time,y=PopTotal,col=Variant,linetype=gt2017))+
geom_line(size=1.5)+
theme_minimal()+
guides(linetype=F)+
ggtitle(paste(location,"'s Total Population by Variant"))
# Save file in new directory if it exists
loc_v = unlist(strsplit(location,"/"))
file = trim(tail(loc_v,1))
folder = paste0(loc_v[1:length(loc_v)-1],collapse = "-")
dir_path = paste0("./PopTotal/",folder,"/")
ggsave(paste0(dir_path,file,".png"))
}
library(data.table)
library(ggplot2)
dt = fread("/Users/michael/Downloads/Rtest/WPP2017_TotalPopulationBySex.csv")
head(dt)
dt[,`:=`(Location=factor(Location),Variant=factor(Variant),Time=as.Date(ISOdate(Time,12,31)))]
summary(dt)
dt = dt[,.(PopMale,PopFemale,PopTotal),.(Location,Time,Variant)]
dt[,gt2017:=Time>as.Date(ISOdate(2017,12,31))]
# 273
trim = function(x) sub("^\\s+","",x)
for(location in unique(dt$Location)){
location_dt = copy(dt[Location==location,.(PopTotal,Time,Variant,gt2017)])
ggplot(data=location_dt,aes(x=Time,y=PopTotal,col=Variant,linetype=gt2017))+
geom_line(size=1.5)+
theme_minimal()+
guides(linetype=F)+
ggtitle(paste(location,"'s Total Population by Variant"))
# Save file in new directory if it exists
loc_v = unlist(strsplit(location,"/"))
file = trim(tail(loc_v,1))
folder = paste0(loc_v[1:length(loc_v)-1],collapse = "-")
dir_path = paste0("./PopTotal/",folder,"-")
ggsave(paste0(dir_path,file,".png"))
}
library(data.table)
library(ggplot2)
dt = fread("/Users/michael/Downloads/Rtest/WPP2017_TotalPopulationBySex.csv")
head(dt)
dt[,`:=`(Location=factor(Location),Variant=factor(Variant),Time=as.Date(ISOdate(Time,12,31)))]
summary(dt)
dt = dt[,.(PopMale,PopFemale,PopTotal),.(Location,Time,Variant)]
dt[,gt2017:=Time>as.Date(ISOdate(2017,12,31))]
# 273
trim = function(x) sub("^\\s+","",x)
for(location in unique(dt$Location)){
location_dt = copy(dt[Location==location,.(PopTotal,Time,Variant,gt2017)])
ggplot(data=location_dt,aes(x=Time,y=PopTotal,col=Variant,linetype=gt2017))+
geom_line(size=1.5)+
theme_minimal()+
guides(linetype=F)+
ggtitle(paste(location,"'s Total Population by Variant"))
# Save file in new directory if it exists
loc_v = unlist(strsplit(location,"/"))
file = trim(tail(loc_v,1))
folder = paste0(loc_v[1:length(loc_v)-1],collapse = "-")
dir_path = paste0("./PopTotal/",folder,ifelse(folder=='','','-'))
ggsave(paste0(dir_path,file,".png"))
}
